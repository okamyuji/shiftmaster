{{define "content"}}
<div class="max-w-2xl mx-auto space-y-6">
    <!-- ページヘッダー -->
    <div class="flex items-center gap-4">
        <a href="/admin/users" class="btn btn-ghost p-2">
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
            </svg>
        </a>
        <div>
            <h1 class="text-3xl font-bold text-white">{{.Title}}</h1>
            <p class="mt-1 text-slate-400">
                {{if .IsNew}}新しいユーザーを登録{{else}}ユーザー情報を編集{{end}}
            </p>
        </div>
    </div>

    <!-- フォーム -->
    <div class="card p-6">
        <form 
            {{if .IsNew}}
            hx-post="/admin/users"
            {{else}}
            hx-put="/admin/users/{{.User.ID}}"
            {{end}}
            hx-target="#form-error"
            hx-swap="innerHTML"
            class="space-y-6"
        >
            <!-- 姓名 -->
            <div class="grid grid-cols-2 gap-4">
                <div>
                    <label for="last_name" class="block text-sm font-medium text-slate-300 mb-2">
                        姓 <span class="text-red-400">*</span>
                    </label>
                    <input 
                        type="text" 
                        id="last_name" 
                        name="last_name" 
                        required
                        class="input"
                        value="{{if .User}}{{.User.LastName}}{{end}}"
                        placeholder="山田"
                    >
                </div>
                <div>
                    <label for="first_name" class="block text-sm font-medium text-slate-300 mb-2">
                        名 <span class="text-red-400">*</span>
                    </label>
                    <input 
                        type="text" 
                        id="first_name" 
                        name="first_name" 
                        required
                        class="input"
                        value="{{if .User}}{{.User.FirstName}}{{end}}"
                        placeholder="太郎"
                    >
                </div>
            </div>

            <!-- メールアドレス -->
            <div>
                <label for="email" class="block text-sm font-medium text-slate-300 mb-2">
                    メールアドレス <span class="text-red-400">*</span>
                </label>
                <input 
                    type="email" 
                    id="email" 
                    name="email" 
                    required
                    class="input"
                    value="{{if .User}}{{.User.Email}}{{end}}"
                    placeholder="yamada@example.com"
                >
            </div>

            {{if .IsNew}}
            <!-- パスワード（新規作成時のみ） -->
            <div>
                <label for="password" class="block text-sm font-medium text-slate-300 mb-2">
                    パスワード <span class="text-red-400">*</span>
                </label>
                <input 
                    type="password" 
                    id="password" 
                    name="password" 
                    required
                    minlength="8"
                    class="input"
                    placeholder="8文字以上で入力"
                >
                <p class="mt-1 text-sm text-slate-500">8文字以上で設定してください</p>
            </div>
            {{end}}

            <!-- ロール -->
            <div>
                <label for="role" class="block text-sm font-medium text-slate-300 mb-2">
                    ロール <span class="text-red-400">*</span>
                </label>
                <select id="role" name="role" class="select" required>
                    {{range .Roles}}
                    <option value="{{.Value}}" {{if $.User}}{{if eq $.User.Role .Value}}selected{{end}}{{end}}>
                        {{.Label}}
                    </option>
                    {{end}}
                </select>
            </div>

            {{if not .IsNew}}
            <!-- ステータス（編集時のみ） -->
            <div>
                <label class="flex items-center gap-3 cursor-pointer">
                    <input 
                        type="checkbox" 
                        name="is_active" 
                        {{if .User.IsActive}}checked{{end}}
                        class="w-5 h-5 rounded border-slate-600 bg-slate-700 text-primary-500 focus:ring-primary-500 focus:ring-offset-0"
                    >
                    <span class="text-slate-300">アカウントを有効にする</span>
                </label>
            </div>
            {{end}}

            <!-- エラー表示エリア -->
            <div id="form-error"></div>

            <!-- 送信ボタン -->
            <div class="flex justify-end gap-3 pt-4 border-t border-slate-700">
                <a href="/admin/users" class="btn btn-ghost">キャンセル</a>
                <button type="submit" class="btn btn-primary">
                    {{if .IsNew}}登録{{else}}更新{{end}}
                </button>
            </div>
        </form>
    </div>
</div>
{{end}}

